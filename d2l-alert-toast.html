<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="./d2l-alert.html">
<!--
`d2l-alert-toast`
Polymer-based web component for a D2L toast alert

@demo demo/index.html
-->

<dom-module id="d2l-alert-toast">
	<template strip-whitespace>
		<style>
			:host {
				border-radius: 0.3rem;
				bottom: 20px;
				box-shadow: 0 0.1rem 0.6rem 0 rgba(0,0,0,0.10);
				left: 0;
				margin: 0 auto;
				max-width: 710px;
				opacity: 0;
				position: fixed;
				right: 0;
				transition-duration: 250ms;
				transition-property: transform, opacity, visibility;
				transition-timing-function: ease-in;
				transform: translateY(0);
				visibility: hidden;
				width: 100%;
				z-index: 2;
			}

			:host([open]) {
				opacity: 1;
				transform: translateY(-10px);
				visibility: visible;
			}

		</style>
		<d2l-alert type$="[[type]]" button-text$="[[buttonText]]" has-close-button$="[[hasCloseButton]]">
			<slot></slot>
			<slot name="subtext"></slot>
		</d2l-alert>
	</template>
	<script>
		Polymer({
			is: 'd2l-alert-toast',

			/**
			 * Fired when the custom action button is pressed.
			 *
			 * @event d2l-alert-button-pressed
			*/

			/**
			 * Fired when the alert is closed/hidden.
			 *
			 * @event d2l-alert-closed
			*/

			listeners: {
				'd2l-alert-closed': '_close'
			},

			properties: {

				/**
				 * Type of alert to display. Valid values are 'default', 'success', 'critical', and 'warning'.
				 * Values "call-to-action" and "error" have been deprecated.
				 *
				 * NOTE: Toast alerts should not be used with 'critical' or 'warning' colors.
				 */
				type: {
					type: String,
					value: 'default',
					reflectToAttribute: true
				},
				/**
				 * Text for a custom action button. If provided, a button will be rendered with the specified text.
				 */
				buttonText: {
					type: String,
					value: null
				},
				/**
				 * Whether to render a close button, allowing the user to hide the alert.
				 */
				hasCloseButton: {
					type: Boolean,
					value: true
				},
				/**
				 * Whether to open the toast alert (make visible) or not.
				 */
				open:{
					type: Boolean,
					value: false,
					reflectToAttribute: true,
					observer: '_changeOpen'
				},
				/**
				 * Whether to automatically close after 2.5 seconds or stay open
				 */
				autoclose:{
					type: Boolean,
					value: true,
					observer: '_changeOpen'
				}
			},

			_changeOpen: function() {

				var alertElement = this.$$('d2l-alert');
				if (alertElement && alertElement.hasAttribute('hidden')) {
					alertElement.removeAttribute('hidden');
				}

				if (this.open && this.autoclose) {
					setTimeout(function() {this.open = false;}.bind(this), 2500);
				}
			},

			_close: function() {
				this.open = false;
			}
		});
	</script>
</dom-module>
